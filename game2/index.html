<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÇØ„ÉÉ„Ç≠„Éº„ÇØ„É™„ÉÉ„Ç´„ÉºÈ¢®„Ç≤„Éº„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        
        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 900px;
            width: 90%;
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 36px;
        }
        
        .game-area {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
        }
        
        .left-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .right-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .stats {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 18px;
        }
        
        .stat-label {
            font-weight: bold;
            color: #555;
        }
        
        .stat-value {
            color: #667eea;
            font-weight: bold;
        }
        
        .cookie-button {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(145deg, #f5deb3, #daa520);
            border: 5px solid #8b6914;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            margin: 30px auto;
            transition: transform 0.1s, box-shadow 0.1s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .cookie-button:hover {
            transform: scale(1.05);
        }
        
        .cookie-button:active {
            transform: scale(0.95);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .click-animation {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            animation: floatUp 1s ease-out forwards;
            pointer-events: none;
        }
        
        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }
        
        .upgrades {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .upgrades h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 24px;
        }
        
        .upgrade-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .upgrade-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .upgrade-item.affordable {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        
        .upgrade-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .upgrade-name {
            font-weight: bold;
            font-size: 18px;
            color: #333;
        }
        
        .upgrade-count {
            background: #667eea;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 14px;
        }
        
        .upgrade-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }
        
        .upgrade-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            width: 100%;
            transition: background 0.3s;
            font-weight: bold;
        }
        
        .upgrade-button:hover:not(:disabled) {
            background: #5568d3;
        }
        
        .upgrade-button:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        .upgrade-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .achievements {
            background: #fff3cd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #ffc107;
        }
        
        .achievements h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .achievement-item {
            background: white;
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .achievement-unlocked {
            color: #28a745;
            font-weight: bold;
        }

        .reset-button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 15px;
            width: 100%;
        }

        .reset-button:hover {
            background: #c82333;
        }

        .game-over-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over-overlay.show {
            display: flex;
        }

        .game-over-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: explosionShake 0.5s;
        }

        @keyframes explosionShake {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-10px, -10px); }
            20% { transform: translate(10px, 10px); }
            30% { transform: translate(-10px, 10px); }
            40% { transform: translate(10px, -10px); }
            50% { transform: translate(-10px, -10px); }
            60% { transform: translate(10px, 10px); }
            70% { transform: translate(-10px, 10px); }
            80% { transform: translate(10px, -10px); }
            90% { transform: translate(-10px, -10px); }
        }

        .game-over-box h2 {
            font-size: 48px;
            color: #dc3545;
            margin-bottom: 20px;
        }

        .game-over-box p {
            font-size: 24px;
            margin: 15px 0;
            color: #333;
        }

        .game-over-box button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }

        .game-over-box button:hover {
            background: #5568d3;
        }

        .cookie-button.bomb {
            background: linear-gradient(145deg, #333, #000);
            animation: bombPulse 0.5s infinite;
        }

        @keyframes bombPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .cookie-button.poison {
            background: linear-gradient(145deg, #9c27b0, #4a148c);
            animation: poisonPulse 0.8s infinite;
        }

        @keyframes poisonPulse {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.05); filter: brightness(1.3); }
        }

        .cookie-button.happy {
            background: linear-gradient(145deg, #ffd700, #ff6b00);
            animation: happySparkle 0.6s infinite;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        @keyframes happySparkle {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }

        .warning-text {
            color: #dc3545;
            font-weight: bold;
            font-size: 18px;
            margin-top: 10px;
            animation: warningBlink 0.5s infinite;
        }

        .warning-text.poison {
            color: #9c27b0;
        }

        .warning-text.happy {
            color: #ffd700;
            animation: happyBlink 0.5s infinite;
        }

        @keyframes warningBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes happyBlink {
            0%, 100% { opacity: 1; text-shadow: 0 0 10px #ffd700; }
            50% { opacity: 0.7; text-shadow: 0 0 20px #ffd700; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üç¢ „Åä„Åß„Çì„ÇØ„É™„ÉÉ„Ç´„Éº üç¢</h1>
        
        <div class="game-area">
            <div class="left-panel">
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-label">„Åä„Åß„Çì:</span>
                        <span class="stat-value" id="cookies">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">1„ÇØ„É™„ÉÉ„ÇØ:</span>
                        <span class="stat-value" id="clickPower">1</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ÊØéÁßí:</span>
                        <span class="stat-value" id="cps">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Á∑èÁîüÁî£:</span>
                        <span class="stat-value" id="total">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">„ÇØ„É™„ÉÉ„ÇØÊï∞:</span>
                        <span class="stat-value" id="clicks">0</span>
                    </div>
                </div>
                
                <div class="cookie-button" id="cookieBtn">
                    üç¢
                </div>
                <div id="warningText" style="text-align: center; min-height: 30px;"></div>
                
                <div class="achievements">
                    <h3>üèÜ ÂÆüÁ∏æ</h3>
                    <div id="achievementsList">„Åæ„Å†ÂÆüÁ∏æ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    <button class="reset-button" id="resetBtn">„Ç≤„Éº„É†„Çí„É™„Çª„ÉÉ„Éà</button>
                </div>
            </div>
            
            <div class="right-panel">
                <div class="upgrades">
                    <h2>„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ</h2>
                    <div id="upgradesList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- „Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÁîªÈù¢ -->
    <div class="game-over-overlay" id="gameOverOverlay">
        <div class="game-over-box">
            <h2>üí• „Ç≤„Éº„É†„Ç™„Éº„Éê„Éº üí•</h2>
            <p>ÁàÜÂºæ„Åä„Åß„Çì„ÇíÈ£ü„Åπ„Å¶„Åó„Åæ„Å£„ÅüÔºÅ</p>
            <p id="finalScore"></p>
            <button id="restartBtn">„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§</button>
        </div>
    </div>

    <script>
        // „Ç≤„Éº„É†„Éá„Éº„Çø
        let gameData = {
            cookies: 0,
            totalCookies: 0,
            clicks: 0,
            cookiesPerClick: 1,
            cookiesPerSecond: 0,
            isBomb: false,
            isPoison: false,
            isHappy: false,
            gameOver: false,
            poisonUnlocked: false,
            poisonRateBonus: 0,
            happyRateBonus: 0,
            upgrades: [
    {
        id: 'cursor',
        name: '„ÅäÁÆ∏',
        baseCost: 15,
        cost: 15,
        owned: 0,
        cps: 0.1,
        emoji: 'ü•¢',
        type: 'passive',
        desc: '„Åä„Åß„Çì„ÇíËá™Âãï„ÅßÂ∞ë„Åó„Åö„Å§Â¢ó„ÇÑ„Åó„Åæ„Åô„ÄÇÔºà+0.1 / ÁßíÔºâ'
    },
    {
        id: 'grandma',
        name: '„Åä„Åß„ÇìÂ±ãÂè∞',
        baseCost: 100,
        cost: 100,
        owned: 0,
        cps: 1,
        emoji: 'üèÆ',
        type: 'passive',
        desc: 'Â±ãÂè∞„ÅåÊØéÁßí„Åä„Åß„Çì„Çí‰Ωú„Çä„Åæ„Åô„ÄÇÔºà+1 / ÁßíÔºâ'
    },
    {
        id: 'farm',
        name: 'Â§ßÊ†πÁïë',
        baseCost: 500,
        cost: 500,
        owned: 0,
        cps: 8,
        emoji: 'üåæ',
        type: 'passive',
        desc: 'Áïë„ÅßÂ§ßÈáè„ÅÆÂ§ßÊ†π„ÇíÁîüÁî£„Åó„Åæ„Åô„ÄÇÔºà+8 / ÁßíÔºâ'
    },
    {
        id: 'factory',
        name: '„Åä„Åß„ÇìÂ∑•Â†¥',
        baseCost: 3000,
        cost: 3000,
        owned: 0,
        cps: 47,
        emoji: 'üè≠',
        type: 'passive',
        desc: 'Â∑•Â†¥„ÅåÂäπÁéáÁöÑ„Å´„Åä„Åß„Çì„ÇíÂ§ßÈáèÁîüÁî£„ÄÇÔºà+47 / ÁßíÔºâ'
    },
    {
        id: 'bank',
        name: '„Åä„Åß„Çì„ÉÅ„Çß„Éº„É≥Â∫ó',
        baseCost: 10000,
        cost: 10000,
        owned: 0,
        cps: 260,
        emoji: 'üè™',
        type: 'passive',
        desc: '„ÉÅ„Çß„Éº„É≥Â∫ó„ÅåÂÖ®ÂõΩ„Åß„Åä„Åß„Çì„ÇíË≤©Â£≤„ÄÇÔºà+260 / ÁßíÔºâ'
    },
    {
        id: 'wizard',
        name: '„Åä„Åß„ÇìÈ≠îÊ≥ï‰Ωø„ÅÑ',
        baseCost: 40000,
        cost: 40000,
        owned: 0,
        cps: 1400,
        emoji: 'üßô',
        type: 'passive',
        desc: 'È≠îÊ≥ï„Åß„Åä„Åß„Çì„ÇíÈå¨Êàê„Åó„Åæ„Åô„ÄÇÔºà+1400 / ÁßíÔºâ'
    },

    {
        id: 'clickPower1',
        name: 'Âº∑Âåñ„ÅäÁÆ∏',
        baseCost: 50,
        cost: 50,
        owned: 0,
        clickBonus: 1,
        emoji: '‚ú®',
        type: 'click',
        desc: '„ÇØ„É™„ÉÉ„ÇØ„ÅßÂæó„Çâ„Çå„Çã„Åä„Åß„Çì„Çí +1 Â¢óÂä†„ÄÇ(„ÇØ„É™„ÉÉ„ÇØ„ÅßÂæó„Çâ„Çå„Çã„Åä„Åß„Çì„Çí +1 Â¢óÂä†)' 
    },
    {
        id: 'clickPower2',
        name: 'ÈªÑÈáë„ÅÆ„ÅäÁÆ∏',
        baseCost: 500,
        cost: 500,
        owned: 0,
        clickBonus: 5,
        emoji: '‚≠ê',
        type: 'click',
        desc: '„ÇØ„É™„ÉÉ„ÇØ„Éë„ÉØ„Éº„Åå„Åï„Çâ„Å´Â¢óÂä†„ÄÇÔºà+5Ôºâ'
    },
    {
        id: 'clickPower3',
        name: '„ÉÄ„Ç§„É§„ÅÆ„ÅäÁÆ∏',
        baseCost: 5000,
        cost: 5000,
        owned: 0,
        clickBonus: 25,
        emoji: 'üíé',
        type: 'click',
        desc: '1„ÇØ„É™„ÉÉ„ÇØ„ÅÆÁç≤ÂæóÈáè„ÅåÂ§ß„Åç„Åè‰∏äÊòá„ÄÇÔºà+25Ôºâ'
    },
    {
        id: 'clickPower4',
        name: '‰ºùË™¨„ÅÆ„ÅäÁÆ∏',
        baseCost: 50000,
        cost: 50000,
        owned: 0,
        clickBonus: 100,
        emoji: 'üëë',
        type: 'click',
        desc: '‰ºùË™¨Á¥ö„ÅÆ„ÅäÁÆ∏„Åß„ÇØ„É™„ÉÉ„ÇØÂäõÂ§ßÂπÖ„Ç¢„ÉÉ„Éó„ÄÇÔºà+100Ôºâ'
    },

    {
        id: 'riskReward1',
        name: 'Âç±Èô∫„Å™Ë™øÂë≥Êñô',
        baseCost: 1000,
        cost: 1000,
        owned: 0,
        cpsBonus: 0.5,
        poisonRate: 0.02,
        emoji: 'üå∂Ô∏è',
        type: 'risk',
        desc: 'ÁîüÁî£Èáè+0.5/Áßí„ÄÇ2%„ÅÆÁ¢∫Áéá„ÅßÊØí„Åä„Åß„ÇìÁô∫Áîü„ÄÇ'
    },
    {
        id: 'riskReward2',
        name: 'ÊøÄËæõ„Çπ„Éë„Ç§„Çπ',
        baseCost: 10000,
        cost: 10000,
        owned: 0,
        cpsBonus: 5,
        poisonRate: 0.03,
        emoji: 'üî•',
        type: 'risk',
        desc: 'ÁîüÁî£Èáè+5/Áßí„ÄÇ3%„ÅÆÁ¢∫Áéá„ÅßÊØí„Åä„Åß„ÇìÁô∫Áîü„ÄÇ'
    },
    {
        id: 'riskReward3',
        name: 'Áßò‰ºù„ÅÆ„Çø„É¨',
        baseCost: 100000,
        cost: 100000,
        owned: 0,
        cpsBonus: 50,
        poisonRate: 0.05,
        emoji: 'üíÄ',
        type: 'risk',
        desc: 'ÁîüÁî£Èáè+50/Áßí„ÄÇ5%„ÅÆÁ¢∫Áéá„ÅßÊØí„Åä„Åß„ÇìÁô∫Áîü„ÄÇ'
    },

    {
        id: 'luckyCharm1',
        name: 'Âπ∏ÈÅã„ÅÆ„ÅäÂÆà„Çä',
        baseCost: 2000,
        cost: 2000,
        owned: 0,
        happyRate: 0.01,
        emoji: 'üçÄ',
        type: 'lucky',
        desc: '1%„ÅÆÁ¢∫Áéá„Åß„Éè„ÉÉ„Éî„Éº„Åä„Åß„ÇìÂá∫Áèæ„ÄÇÁç≤ÂæóÈáè2ÂÄç„ÄÇ'
    },
    {
        id: 'luckyCharm2',
        name: 'ÈªÑÈáë„ÅÆÊãõ„ÅçÁå´',
        baseCost: 20000,
        cost: 20000,
        owned: 0,
        happyRate: 0.02,
        emoji: 'üê±',
        type: 'lucky',
        desc: '„Éè„ÉÉ„Éî„Éº„Åä„Åß„Çì„ÅÆÁô∫ÁîüÁéá„Åå„Åï„Çâ„Å´‰∏äÊòá„ÄÇÔºà+2%Ôºâ'
    },
    {
        id: 'luckyCharm3',
        name: 'Âõõ„Å§Ëëâ„ÅÆ„ÇØ„É≠„Éº„Éê„Éº',
        baseCost: 200000,
        cost: 200000,
        owned: 0,
        happyRate: 0.04,
        emoji: 'üåà',
        type: 'lucky',
        desc: '„Éè„ÉÉ„Éî„Éº„Åä„Åß„ÇìÁô∫ÁîüÁéá +4%„ÄÇË∂Ö„É©„ÉÉ„Ç≠„ÉºÁä∂ÊÖãÔºÅ'
    }
],

achievements: [
                { id: 'first', name: 'ÊúÄÂàù„ÅÆ‰∏ÄÊ≠©', condition: () => gameData.totalCookies >= 1, unlocked: false },
                { id: 'hundred', name: '100ÊûöÈÅîÊàê', condition: () => gameData.totalCookies >= 100, unlocked: false },
                { id: 'thousand', name: '1000ÊûöÈÅîÊàê', condition: () => gameData.totalCookies >= 1000, unlocked: false },
                { id: 'clicker', name: '„ÇØ„É™„ÉÉ„ÇØ„Éû„Çπ„Çø„Éº', condition: () => gameData.clicks >= 100, unlocked: false },
                { id: 'buyer', name: 'Âàù„ÇÅ„Å¶„ÅÆË≥ºÂÖ•', condition: () => gameData.upgrades.some(u => u.owned > 0), unlocked: false }
            ]
        };

        // Ë¶ÅÁ¥†ÂèñÂæó
        const cookieBtn = document.getElementById('cookieBtn');
        const cookiesDisplay = document.getElementById('cookies');
        const clickPowerDisplay = document.getElementById('clickPower');
        const cpsDisplay = document.getElementById('cps');
        const totalDisplay = document.getElementById('total');
        const clicksDisplay = document.getElementById('clicks');
        const upgradesList = document.getElementById('upgradesList');
        const achievementsList = document.getElementById('achievementsList');
        const resetBtn = document.getElementById('resetBtn');
        const gameOverOverlay = document.getElementById('gameOverOverlay');
        const restartBtn = document.getElementById('restartBtn');
        const finalScore = document.getElementById('finalScore');
        const warningText = document.getElementById('warningText');

        // „ÇØ„ÉÉ„Ç≠„Éº„Çí„ÇØ„É™„ÉÉ„ÇØ
        cookieBtn.addEventListener('click', (e) => {
            if (gameData.gameOver) return;
            
            // ÁàÜÂºæ„Å†„Å£„ÅüÂ†¥Âêà„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº
            if (gameData.isBomb) {
                triggerGameOver();
                return;
            }
            
            // ÊØí„Åä„Åß„Çì„Å†„Å£„ÅüÂ†¥Âêà
            if (gameData.isPoison) {
                const loss = Math.floor(gameData.cookies * 0.1); // ÁèæÂú®„ÅÆ„Åä„Åß„Çì„ÅÆ10%„ÇíÂ§±„ÅÜ
                gameData.cookies = Math.max(0, gameData.cookies - loss);
                
                // „Éû„Ç§„Éä„ÇπË°®Á§∫„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                const animation = document.createElement('div');
                animation.className = 'click-animation';
                animation.style.color = '#9c27b0';
                animation.textContent = `-${loss}`;
                animation.style.left = (Math.random() * 100 - 50) + 'px';
                cookieBtn.appendChild(animation);
                
                setTimeout(() => animation.remove(), 1000);
                
                // ÊØíÁä∂ÊÖã„ÇíËß£Èô§
                gameData.isPoison = false;
                cookieBtn.classList.remove('poison');
                cookieBtn.textContent = 'üç¢';
                warningText.innerHTML = '';
                
                updateDisplay();
                return;
            }
            
            // „Éè„ÉÉ„Éî„Éº„Åä„Åß„Çì„ÅÆÂ†¥Âêà„ÅØ2ÂÄç
            let gain = gameData.cookiesPerClick;
            if (gameData.isHappy) {
                gain *= 2;
                
                // „Éè„ÉÉ„Éî„ÉºÁä∂ÊÖã„ÇíËß£Èô§
                gameData.isHappy = false;
                cookieBtn.classList.remove('happy');
                cookieBtn.textContent = 'üç¢';
                warningText.innerHTML = '';
            }
            
            gameData.cookies += gain;
            gameData.totalCookies += gain;
            gameData.clicks++;
            
            // „ÇØ„É™„ÉÉ„ÇØ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            const animation = document.createElement('div');
            animation.className = 'click-animation';
            animation.textContent = `+${gain}`;
            animation.style.left = (Math.random() * 100 - 50) + 'px';
            if (gain > gameData.cookiesPerClick) {
                animation.style.color = '#ffd700';
                animation.style.fontSize = '32px';
            }
            cookieBtn.appendChild(animation);
            
            setTimeout(() => animation.remove(), 1000);
            
            updateDisplay();
            checkAchievements();
        });

        // „É™„Çª„ÉÉ„Éà„Éú„Çø„É≥
        resetBtn.addEventListener('click', () => {
            if (confirm('Êú¨ÂΩì„Å´„Ç≤„Éº„É†„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü„Åô„Åπ„Å¶„ÅÆÈÄ≤Ë°åÁä∂Ê≥Å„ÅåÂ§±„Çè„Çå„Åæ„Åô„ÄÇ')) {
                resetGameData();
            }
        });

        // ÂÜç„Çπ„Çø„Éº„Éà„Éú„Çø„É≥
        restartBtn.addEventListener('click', () => {
            gameOverOverlay.classList.remove('show');
            resetGameData();
        });

        // „Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„ÇíË≥ºÂÖ•Ôºà„Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞„Å®„Åó„Å¶ÂÆöÁæ©Ôºâ
        window.buyUpgrade = function(upgradeId) {
            const upgrade = gameData.upgrades.find(u => u.id === upgradeId);
            
            if (gameData.cookies >= upgrade.cost) {
                gameData.cookies -= upgrade.cost;
                upgrade.owned++;
                upgrade.cost = Math.floor(upgrade.baseCost * Math.pow(1.15, upgrade.owned));
                
                // „É™„Çπ„ÇØÁ≥ª„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„ÅÆÂ†¥Âêà
                if (upgrade.type === 'risk') {
                    gameData.poisonRateBonus += upgrade.poisonRate;
                }
                
                // Âπ∏ÈÅãÁ≥ª„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„ÅÆÂ†¥Âêà
                if (upgrade.type === 'lucky') {
                    gameData.happyRateBonus += upgrade.happyRate;
                }
                
                calculateCPS();
                calculateClickPower();
                updateDisplay();
                renderUpgrades(upgradeDiv.innerHTML = `
    <div class="upgrade-header">
        <span class="upgrade-name">${u.emoji} ${u.name}</span>
        <span class="upgrade-count">x ${u.owned}</span>
    </div>
    <div class="upgrade-info">
        <span>${u.desc}</span>
        <span>üí∞ ${u.cost}</span>
    </div>
    <button class="upgrade-button" onclick="buyUpgrade('${u.id}')" 
        ${gameData.cookies < u.cost ? 'disabled' : ''}>Ë≥ºÂÖ•</button>
`,
);
                checkAchievements();
            }
        };

        // „Ç≤„Éº„É†„Çí„É™„Çª„ÉÉ„Éà
        window.resetGame = function() {
            resetBtn.click();
        };

        // „Éá„Éº„Çø„É™„Çª„ÉÉ„ÉàÈñ¢Êï∞
        function resetGameData() {
                            gameData = {
                cookies: 0,
                totalCookies: 0,
                clicks: 0,
                cookiesPerClick: 1,
                cookiesPerSecond: 0,
                isBomb: false,
                isPoison: false,
                isHappy: false,
                gameOver: false,
                poisonUnlocked: false,
                poisonRateBonus: 0,
                happyRateBonus: 0,
                upgrades: [
                    {
                        id: 'cursor',
                        name: '„ÅäÁÆ∏',
                        baseCost: 15,
                        cost: 15,
                        owned: 0,
                        cps: 0.1,
                        emoji: 'ü•¢',
                        type: 'passive'
                    },
                    {
                        id: 'grandma',
                        name: '„Åä„Åß„ÇìÂ±ãÂè∞',
                        baseCost: 100,
                        cost: 100,
                        owned: 0,
                        cps: 1,
                        emoji: 'üèÆ',
                        type: 'passive'
                    },
                    {
                        id: 'farm',
                        name: 'Â§ßÊ†πÁïë',
                        baseCost: 500,
                        cost: 500,
                        owned: 0,
                        cps: 8,
                        emoji: 'üåæ',
                        type: 'passive'
                    },
                    {
                        id: 'factory',
                        name: '„Åä„Åß„ÇìÂ∑•Â†¥',
                        baseCost: 3000,
                        cost: 3000,
                        owned: 0,
                        cps: 47,
                        emoji: 'üè≠',
                        type: 'passive'
                    },
                    {
                        id: 'bank',
                        name: '„Åä„Åß„Çì„ÉÅ„Çß„Éº„É≥Â∫ó',
                        baseCost: 10000,
                        cost: 10000,
                        owned: 0,
                        cps: 260,
                        emoji: 'üè™',
                        type: 'passive'
                    },
                    {
                        id: 'wizard',
                        name: '„Åä„Åß„ÇìÈ≠îÊ≥ï‰Ωø„ÅÑ',
                        baseCost: 40000,
                        cost: 40000,
                        owned: 0,
                        cps: 1400,
                        emoji: 'üßô',
                        type: 'passive'
                    },
                    {
                        id: 'clickPower1',
                        name: 'Âº∑Âåñ„ÅäÁÆ∏',
                        baseCost: 50,
                        cost: 50,
                        owned: 0,
                        clickBonus: 1,
                        emoji: '‚ú®',
                        type: 'click'
                    },
                    {
                        id: 'clickPower2',
                        name: 'ÈªÑÈáë„ÅÆ„ÅäÁÆ∏',
                        baseCost: 500,
                        cost: 500,
                        owned: 0,
                        clickBonus: 5,
                        emoji: '‚≠ê',
                        type: 'click'
                    },
                    {
                        id: 'clickPower3',
                        name: '„ÉÄ„Ç§„É§„ÅÆ„ÅäÁÆ∏',
                        baseCost: 5000,
                        cost: 5000,
                        owned: 0,
                        clickBonus: 25,
                        emoji: 'üíé',
                        type: 'click'
                    },
                    {
                        id: 'clickPower4',
                        name: '‰ºùË™¨„ÅÆ„ÅäÁÆ∏',
                        baseCost: 50000,
                        cost: 50000,
                        owned: 0,
                        clickBonus: 100,
                        emoji: 'üëë',
                        type: 'click'
                    },
                    {
                        id: 'riskReward1',
                        name: 'Âç±Èô∫„Å™Ë™øÂë≥Êñô',
                        baseCost: 1000,
                        cost: 1000,
                        owned: 0,
                        cpsBonus: 0.5,
                        poisonRate: 0.02,
                        emoji: 'üå∂Ô∏è',
                        type: 'risk'
                    },
                    {
                        id: 'riskReward2',
                        name: 'ÊøÄËæõ„Çπ„Éë„Ç§„Çπ',
                        baseCost: 10000,
                        cost: 10000,
                        owned: 0,
                        cpsBonus: 5,
                        poisonRate: 0.03,
                        emoji: 'üî•',
                        type: 'risk'
                    },
                    {
                        id: 'riskReward3',
                        name: 'Áßò‰ºù„ÅÆ„Çø„É¨',
                        baseCost: 100000,
                        cost: 100000,
                        owned: 0,
                        cpsBonus: 50,
                        poisonRate: 0.05,
                        emoji: 'üíÄ',
                        type: 'risk'
                    },
                    {
                        id: 'luckyCharm1',
                        name: 'Âπ∏ÈÅã„ÅÆ„ÅäÂÆà„Çä',
                        baseCost: 2000,
                        cost: 2000,
                        owned: 0,
                        happyRate: 0.01,
                        emoji: 'üçÄ',
                        type: 'lucky'
                    },
                    {
                        id: 'luckyCharm2',
                        name: 'ÈªÑÈáë„ÅÆÊãõ„ÅçÁå´',
                        baseCost: 20000,
                        cost: 20000,
                        owned: 0,
                        happyRate: 0.02,
                        emoji: 'üê±',
                        type: 'lucky'
                    },
                    {
                        id: 'luckyCharm3',
                        name: 'Âõõ„Å§Ëëâ„ÅÆ„ÇØ„É≠„Éº„Éê„Éº',
                        baseCost: 200000,
                        cost: 200000,
                        owned: 0,
                        happyRate: 0.04,
                        emoji: 'üåà',
                        type: 'lucky'
                    }
                ],
                achievements: [
                    { id: 'first', name: 'ÊúÄÂàù„ÅÆ‰∏ÄÊ≠©', condition: () => gameData.totalCookies >= 1, unlocked: false },
                    { id: 'hundred', name: '100ÊûöÈÅîÊàê', condition: () => gameData.totalCookies >= 100, unlocked: false },
                    { id: 'thousand', name: '1000ÊûöÈÅîÊàê', condition: () => gameData.totalCookies >= 1000, unlocked: false },
                    { id: 'clicker', name: '„ÇØ„É™„ÉÉ„ÇØ„Éû„Çπ„Çø„Éº', condition: () => gameData.clicks >= 100, unlocked: false },
                    { id: 'buyer', name: 'Âàù„ÇÅ„Å¶„ÅÆË≥ºÂÖ•', condition: () => gameData.upgrades.some(u => u.owned > 0), unlocked: false }
                ]
            };
            
            localStorage.removeItem('cookieGameData');
            cookieBtn.classList.remove('bomb', 'poison', 'happy');
            cookieBtn.textContent = 'üç¢';
            warningText.innerHTML = '';
            
            calculateCPS();
            calculateClickPower();
            updateDisplay();
            renderUpgrades();
            renderAchievements();
        }

        // „Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÂá¶ÁêÜ
        function triggerGameOver() {
            gameData.gameOver = true;
            finalScore.textContent = `ÊúÄÁµÇ„Çπ„Ç≥„Ç¢: ${Math.floor(gameData.totalCookies).toLocaleString()} „Åä„Åß„Çì`;
            gameOverOverlay.classList.add('show');
        }

        // ÁàÜÂºæÂåñÂá¶ÁêÜ
        function makeBomb() {
            if (gameData.gameOver || gameData.isBomb || gameData.isPoison || gameData.isHappy) return;
            
            gameData.isBomb = true;
            cookieBtn.classList.add('bomb');
            cookieBtn.textContent = 'üí£';
            warningText.innerHTML = '<span class="warning-text">‚ö†Ô∏è Âç±Èô∫ÔºÅÁàÜÂºæ„Åä„Åß„ÇìÔºÅ„ÇØ„É™„ÉÉ„ÇØ„Åó„Å™„ÅÑ„ÅßÔºÅ ‚ö†Ô∏è</span>';
            
            // 3„Äú5ÁßíÂæå„Å´Ëß£Èô§
            const duration = 3000 + Math.random() * 2000;
            setTimeout(() => {
                if (!gameData.gameOver && gameData.isBomb) {
                    gameData.isBomb = false;
                    cookieBtn.classList.remove('bomb');
                    cookieBtn.textContent = 'üç¢';
                    warningText.innerHTML = '';
                }
            }, duration);
        }

        // ÊØí„Åä„Åß„ÇìÂåñÂá¶ÁêÜ
        function makePoison() {
            // ÊØí„Åä„Åß„Çì„Åå„Ç¢„É≥„É≠„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØÂá∫Áèæ„Åó„Å™„ÅÑ
            if (!gameData.poisonUnlocked) return;
            if (gameData.gameOver || gameData.isBomb || gameData.isPoison || gameData.isHappy) return;
            
            gameData.isPoison = true;
            cookieBtn.classList.add('poison');
            cookieBtn.textContent = '‚ò†Ô∏è';
            warningText.innerHTML = '<span class="warning-text poison">‚ö†Ô∏è ÊØí„Åä„Åß„ÇìÔºÅ„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®„Åä„Åß„Çì„ÅåÊ∏õ„ÇãÔºÅ ‚ö†Ô∏è</span>';
            
            // 4„Äú6ÁßíÂæå„Å´Ëß£Èô§
            const duration = 4000 + Math.random() * 2000;
            setTimeout(() => {
                if (!gameData.gameOver && gameData.isPoison) {
                    gameData.isPoison = false;
                    cookieBtn.classList.remove('poison');
                    cookieBtn.textContent = 'üç¢';
                    warningText.innerHTML = '';
                }
            }, duration);
        }

        // „Éè„ÉÉ„Éî„Éº„Åä„Åß„ÇìÂåñÂá¶ÁêÜ
        function makeHappy() {
            if (gameData.gameOver || gameData.isBomb || gameData.isPoison || gameData.isHappy) return;
            
            gameData.isHappy = true;
            cookieBtn.classList.add('happy');
            cookieBtn.textContent = 'üåü';
            warningText.innerHTML = '<span class="warning-text happy">‚ú® „É©„ÉÉ„Ç≠„ÉºÔºÅÁç≤ÂæóÈáè2ÂÄçÔºÅ ‚ú®</span>';
            
            // 5„Äú7ÁßíÂæå„Å´Ëß£Èô§
            const duration = 5000 + Math.random() * 2000;
            setTimeout(() => {
                if (!gameData.gameOver && gameData.isHappy) {
                    gameData.isHappy = false;
                    cookieBtn.classList.remove('happy');
                    cookieBtn.textContent = 'üç¢';
                    warningText.innerHTML = '';
                }
            }, duration);
        }

        // „É©„É≥„ÉÄ„É†„Ç§„Éô„É≥„Éà„ÇíÁô∫Áîü„Åï„Åõ„Çã
        function startEventTimer() {
            setInterval(() => {
                if (gameData.gameOver || gameData.isBomb || gameData.isPoison || gameData.isHappy) return;
                
                const rand = Math.random();
                
                // Âü∫Êú¨Á¢∫Áéá
                const bombRate = 0.015; // 1.5%
                const basePoisonRate = 0.01; // 1%Ôºà‰∏ã„Åí„Åæ„Åó„ÅüÔºâ
                const baseHappyRate = 0.02; // 2%
                
                // „Éú„Éº„Éä„Çπ„ÇíÂä†ÁÆó
                const totalPoisonRate = basePoisonRate + gameData.poisonRateBonus;
                const totalHappyRate = baseHappyRate + gameData.happyRateBonus;
                
                // ÁàÜÂºæ
                if (rand < bombRate) {
                    makeBomb();
                }
                // ÊØí„Åä„Åß„ÇìÔºà„Ç¢„É≥„É≠„ÉÉ„ÇØÊ∏à„Åø„ÅÆÂ†¥Âêà„ÅÆ„ÅøÔºâ
                else if (gameData.poisonUnlocked && rand < bombRate + totalPoisonRate) {
                    makePoison();
                }
                // „Éè„ÉÉ„Éî„Éº„Åä„Åß„Çì
                else if (rand < bombRate + totalPoisonRate + totalHappyRate) {
                    makeHappy();
                }
            }, 1000);
        }

        // ÊØéÁßí„ÅÆ„ÇØ„ÉÉ„Ç≠„ÉºÁîüÁî£Èáè„ÇíË®àÁÆó
        function calculateCPS() {
            gameData.cookiesPerSecond = 0;
            let baseCPS = 0;
            
            // Âü∫Êú¨„ÅÆËá™ÂãïÁîüÁî£„ÇíË®àÁÆó
            gameData.upgrades.forEach(upgrade => {
                if (upgrade.type === 'passive') {
                    baseCPS += upgrade.cps * upgrade.owned;
                }
            });
            
            gameData.cookiesPerSecond = baseCPS;
            
            // „É™„Çπ„ÇØÁ≥ª„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„ÅÆ„Éú„Éº„Éä„Çπ„ÇíÈÅ©Áî®
            gameData.upgrades.forEach(upgrade => {
                if (upgrade.type === 'risk' && upgrade.owned > 0) {
                    gameData.cookiesPerSecond += upgrade.cpsBonus * upgrade.owned * (baseCPS > 0 ? baseCPS : 1);
                }
            });
        }

        // „ÇØ„É™„ÉÉ„ÇØÂäõ„ÇíË®àÁÆó
        function calculateClickPower() {
            gameData.cookiesPerClick = 1;
            gameData.upgrades.forEach(upgrade => {
                if (upgrade.type === 'click') {
                    gameData.cookiesPerClick += upgrade.clickBonus * upgrade.owned;
                }
            });
        }

        // Ë°®Á§∫„ÇíÊõ¥Êñ∞
        function updateDisplay() {
            cookiesDisplay.textContent = Math.floor(gameData.cookies).toLocaleString();
            clickPowerDisplay.textContent = gameData.cookiesPerClick.toLocaleString();
            cpsDisplay.textContent = gameData.cookiesPerSecond.toFixed(1);
            totalDisplay.textContent = Math.floor(gameData.totalCookies).toLocaleString();
            clicksDisplay.textContent = gameData.clicks.toLocaleString();
            
            // ÊØí„Åä„Åß„Çì„ÅÆ„Ç¢„É≥„É≠„ÉÉ„ÇØ„ÉÅ„Çß„ÉÉ„ÇØ
            if (!gameData.poisonUnlocked && gameData.totalCookies >= 500) {
                gameData.poisonUnlocked = true;
            }
        }

        // „Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„É™„Çπ„Éà„ÇíÊèèÁîª
        function renderUpgrades() {
            upgradesList.innerHTML = '';
            
            gameData.upgrades.forEach(upgrade => {
                const canAfford = gameData.cookies >= upgrade.cost;
                
                const upgradeDiv = document.createElement('div');
                upgradeDiv.className = `upgrade-item ${canAfford ? 'affordable' : 'locked'}`;
                
                upgradeDiv.innerHTML = `
                    <div class="upgrade-header">
                        <span class="upgrade-name">${upgrade.emoji} ${upgrade.name}</span>
                        <span class="upgrade-count">${upgrade.owned}</span>
                    </div>
                    <div class="upgrade-info">
                        <span>+${upgrade.cps}/Áßí</span>
                        <span>üí∞ ${upgrade.cost.toLocaleString()}</span>
                    </div>
                    <button class="upgrade-button" ${!canAfford ? 'disabled' : ''} onclick="buyUpgrade('${upgrade.id}')">
                        ${canAfford ? 'Ë≥ºÂÖ•„Åô„Çã' : '„ÇØ„ÉÉ„Ç≠„Éº„Åå‰∏çË∂≥'}
                    </button>
                `;
                
                upgradesList.appendChild(upgradeDiv);
            });
        }

        // ÂÆüÁ∏æ„Çí„ÉÅ„Çß„ÉÉ„ÇØ
        function checkAchievements() {
            let newUnlock = false;
            
            gameData.achievements.forEach(achievement => {
                if (!achievement.unlocked && achievement.condition()) {
                    achievement.unlocked = true;
                    newUnlock = true;
                }
            });
            
            if (newUnlock) renderAchievements();
        }

        // ÂÆüÁ∏æ„É™„Çπ„Éà„ÇíÊèèÁîª
        function renderAchievements() {
            const unlockedAchievements = gameData.achievements.filter(a => a.unlocked);
            
            if (unlockedAchievements.length === 0) {
                achievementsList.innerHTML = '„Åæ„Å†ÂÆüÁ∏æ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì';
                return;
            }
            
            achievementsList.innerHTML = '';
            
            unlockedAchievements.forEach(achievement => {
                const achDiv = document.createElement('div');
                achDiv.className = 'achievement-item achievement-unlocked';
                achDiv.textContent = `‚úì ${achievement.name}`;
                achievementsList.appendChild(achDiv);
            });
        }

        // ÊØéÁßí„ÇØ„ÉÉ„Ç≠„Éº„ÇíÁîüÁî£
        setInterval(() => {
            if (gameData.cookiesPerSecond > 0) {
                const gain = gameData.cookiesPerSecond / 10;
                gameData.cookies += gain;
                gameData.totalCookies += gain;
                updateDisplay();
            }
        }, 100);

        // ÂÆöÊúüÁöÑ„Å´„Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„É™„Çπ„Éà„ÇíÊõ¥Êñ∞ÔºàË≥ºÂÖ•ÂèØËÉΩÁä∂ÊÖã„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞Ôºâ
        setInterval(() => {
            renderUpgrades();
        }, 500);

        // Ëá™Âãï‰øùÂ≠ò
        setInterval(() => {
            localStorage.setItem('cookieGameData', JSON.stringify(gameData));
        }, 5000);

        // „Ç≤„Éº„É†Ë™≠„ÅøËæº„Åø
        function loadGame() {
            const saved = localStorage.getItem('cookieGameData');
            if (saved) {
                try {
                    const loaded = JSON.parse(saved);
                    // „Éá„Éº„Çø„Çí„Éû„Éº„Ç∏
                    gameData.cookies = loaded.cookies || 0;
                    gameData.totalCookies = loaded.totalCookies || 0;
                    gameData.clicks = loaded.clicks || 0;
                    gameData.cookiesPerClick = loaded.cookiesPerClick || 1;
                    
                    // „Ç¢„ÉÉ„Éó„Ç∞„É¨„Éº„Éâ„Éá„Éº„Çø„ÇíÂæ©ÂÖÉ
                    if (loaded.upgrades) {
                        loaded.upgrades.forEach((savedUpgrade, index) => {
                            if (gameData.upgrades[index]) {
                                gameData.upgrades[index].owned = savedUpgrade.owned || 0;
                                gameData.upgrades[index].cost = savedUpgrade.cost || gameData.upgrades[index].baseCost;
                            }
                        });
                    }
                    
                    // ÊØí„Éª„Éè„ÉÉ„Éî„Éº„Éú„Éº„Éä„Çπ„ÇíÂæ©ÂÖÉ
                    gameData.poisonUnlocked = loaded.poisonUnlocked || false;
                    gameData.poisonRateBonus = loaded.poisonRateBonus || 0;
                    gameData.happyRateBonus = loaded.happyRateBonus || 0;
                    
                    // ÂÆüÁ∏æ„Éá„Éº„Çø„ÇíÂæ©ÂÖÉ
                    if (loaded.achievements) {
                        loaded.achievements.forEach((savedAch, index) => {
                            if (gameData.achievements[index]) {
                                gameData.achievements[index].unlocked = savedAch.unlocked || false;
                            }
                        });
                    }
                    
                    calculateCPS();
                } catch (e) {
                    console.error('„Çª„Éº„Éñ„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', e);
                }
            }
            calculateClickPower();
            updateDisplay();
            renderUpgrades();
            renderAchievements();
        }

        // ÂàùÊúüÂåñ
        loadGame();
        startEventTimer();
    </script>
</body>
</html>